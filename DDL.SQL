CREATE OR REPLACE TABLE PORTFOLIO_DEV_DB.REALASSET_L0.RUNNING_STATS (
	REPORT_ID VARCHAR(16777216),
    DOMAIN_NAME VARCHAR(16777216),
	BATCH_ID VARCHAR(16777216),
	EXT_START_TIME TIMESTAMP_NTZ(9),
	EXT_END_TIME TIMESTAMP_NTZ(9),
	API_CALL_RESULT_1 VARCHAR(16777216),
	API_CALL_2 VARCHAR(16777216),
	API_CALL_RESULT_2 VARCHAR(16777216),
	CAPTURED_TIME TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	STATUS VARCHAR(16777216) DEFAULT 'UNKNOWN',
	RUN_DAY DATE
);


CREATE OR REPLACE TABLE PORTFOLIO_DEV_DB.REALASSET_L0.RUNNING_STATS_HISTORY (
	REPORT_ID VARCHAR(16777216),
	BATCH_ID VARCHAR(16777216),
	EXT_START_TIME TIMESTAMP_NTZ(9),
	EXT_END_TIME TIMESTAMP_NTZ(9),
	API_CALL_RESULT_1 VARCHAR(16777216),
	API_CALL_2 VARCHAR(16777216),
	API_CALL_RESULT_2 VARCHAR(16777216),
	CAPTURED_TIME TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	STATUS VARCHAR(16777216) DEFAULT 'UNKNOWN',
	RUN_DAY DATE
);
CREATE OR REPLACE TABLE PORTFOLIO_DEV_DB.REALASSET_L0.RUNNING_STATS_ERROR (
	REPORT_ID VARCHAR(16777216),
	BATCH_ID VARCHAR(16777216),
	EXT_START_TIME TIMESTAMP_NTZ(9),
	EXT_END_TIME TIMESTAMP_NTZ(9),
	API_CALL_RESULT_1 VARCHAR(16777216),
	API_CALL_2 VARCHAR(16777216),
	API_CALL_RESULT_2 VARCHAR(16777216),
	CAPTURED_TIME TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	STATUS VARCHAR(16777216) DEFAULT 'UNKNOWN',
	RUN_DAY DATE
);

INSERT INTO RUNNING_STATS_ERROR 
SELECT 
        REPORT_ID,
        BATCH_ID,
        EXT_START_TIME,
        EXT_END_TIME,
        API_CALL_RESULT_1,
        API_CALL_2,
        API_CALL_RESULT_2,
        CAPTURED_TIME,
        STATUS,
        RUN_DAY
FROM PORTFOLIO_DEV_DB.REALASSET_L0.RUNNING_STATS
WHERE STATUS = 'ERROR'; 